import{u as F,g as ee,h as se,i as j,j as le,k as ae,t as te,l as ie,m as L,n as H,p as re,w as ue,q as l,v as ne,R as M,x as oe,y as me,z as ce,D as pe,A as ve,B as he,C as de,E as ye,F as Se,G as f,H as we,I as ge,J as Oe,K as be,L as $,M as P,N as xe}from"./app-DZ8Vw2As.js";const He=["/","/OpenHw/","/OpenSw/","/pages/About.html","/OpenSw/Danmu.Server/","/OpenSw/Danmu.Server/artplayer-danmu.html","/OpenSw/Danmu.Server/dplayer-danmu.html","/OpenSw/Danmu.Server/install-on-baota.html","/OpenSw/Danmu.Server/install.html","/OpenSw/Overview/public-service.html","/OpenSw/SbModbus/BitConverter.html","/OpenSw/SbModbus/","/OpenSw/SbModbus/SourceGenerator.html","/OpenSw/UnitySbTemplate/","/OpenSw/UnitySbTemplate/SbGameObject.html","/OpenSw/UnitySbTemplate/UnityPackageOffline.html","/OpenSw/hexo-tag-mmedia/","/OpenSw/hexo-tag-mmedia/aplayer.html","/OpenSw/hexo-tag-mmedia/artplayer.html","/OpenSw/hexo-tag-mmedia/audio.html","/OpenSw/hexo-tag-mmedia/bilibili.html","/OpenSw/hexo-tag-mmedia/developer-doc.html","/OpenSw/hexo-tag-mmedia/dplayer.html","/OpenSw/hexo-tag-mmedia/install.html","/OpenSw/hexo-tag-mmedia/meting.html","/OpenSw/hexo-tag-mmedia/version0.html","/OpenSw/hexo-tag-mmedia/video.html","/OpenSw/hexo-tag-mmedia/xigua.html","/OpenSw/vuepress-plugin-sbaudio/","/OpenSw/vuepress-plugin-sbaudio/aplayer.html","/OpenSw/vuepress-plugin-sbaudio/aplayerGlobal.html","/OpenSw/vuepress-plugin-sbaudio/install.html","/OpenSw/vuepress-plugin-sbaudio/meting.html","/OpenHw/CameraBattery/DMW-BLK22/","/OpenHw/ObsKeyboard/SB00/","/OpenSw/UnitySbTemplate/ThirdPartyPackageExt/","/OpenSw/UnitySbTemplate/ThirdPartyPackageExt/UniTask.YooAsset.html","/404.html","/pages/","/OpenSw/Overview/","/OpenHw/CameraBattery/","/OpenHw/ObsKeyboard/"],fe="SLIMSEARCH_QUERY_HISTORY",y=F(fe,[]),ke=()=>{const{queryHistoryCount:a}=f,t=a>0;return{enabled:t,queryHistories:y,addQueryHistory:i=>{t&&(y.value=Array.from(new Set([i,...y.value.slice(0,a-1)])))},removeQueryHistory:i=>{y.value=[...y.value.slice(0,i),...y.value.slice(i+1)]}}},U=a=>He[a.id]+("anchor"in a?`#${a.anchor}`:""),Re="SLIMSEARCH_RESULT_HISTORY",{resultHistoryCount:B}=f,S=F(Re,[]),Ce=()=>{const a=B>0;return{enabled:a,resultHistories:S,addResultHistory:t=>{if(a){const i={link:U(t),display:t.display};"header"in t&&(i.header=t.header),S.value=[i,...S.value.slice(0,B-1)]}},removeResultHistory:t=>{S.value=[...S.value.slice(0,t),...S.value.slice(t+1)]}}},qe=a=>{const t=pe(),i=j(),k=ve(),u=L(0),g=H(()=>u.value>0),h=he([]);return de(()=>{const{search:d,terminate:R}=ye(),w=Se(o=>{const{resultsFilter:O=n=>n,querySplitter:A,suggestionsFilter:C,...q}=t.value;o?(u.value+=1,d(o,i.value,q).then(n=>O(n,o,i.value,k.value)).then(n=>{u.value-=1,h.value=n}).catch(n=>{console.warn(n),u.value-=1,u.value||(h.value=[])})):h.value=[]},f.searchDelay-f.suggestDelay,{maxWait:5e3});we([a,i],([o])=>w(o.join(" "))),ge(()=>{R()})}),{isSearching:g,results:h}};var Qe=ee({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(a,{emit:t}){const i=se(),k=j(),u=le(ae),{enabled:g,addQueryHistory:h,queryHistories:d,removeQueryHistory:R}=ke(),{enabled:w,resultHistories:o,addResultHistory:O,removeResultHistory:A}=Ce(),C=g||w,q=te(a,"queries"),{results:n,isSearching:G}=qe(q),r=ie({isQuery:!0,index:0}),p=L(0),v=L(0),E=H(()=>C&&(d.value.length>0||o.value.length>0)),D=H(()=>n.value.length>0),Q=H(()=>n.value[p.value]||null),K=()=>{const{isQuery:e,index:s}=r;s===0?(r.isQuery=!e,r.index=e?o.value.length-1:d.value.length-1):r.index=s-1},Y=()=>{const{isQuery:e,index:s}=r;s===(e?d.value.length-1:o.value.length-1)?(r.isQuery=!e,r.index=0):r.index=s+1},_=()=>{p.value=p.value>0?p.value-1:n.value.length-1,v.value=Q.value.contents.length-1},W=()=>{p.value=p.value<n.value.length-1?p.value+1:0,v.value=0},z=()=>{v.value<Q.value.contents.length-1?v.value+=1:W()},J=()=>{v.value>0?v.value-=1:_()},T=e=>e.map(s=>xe(s)?s:l(s[0],s[1])),N=e=>{if(e.type==="customField"){const s=Oe[e.index]||"$content",[m,x=""]=be(s)?s[k.value].split("$content"):s.split("$content");return e.display.map(c=>l("div",T([m,...c,x])))}return e.display.map(s=>l("div",T(s)))},b=()=>{p.value=0,v.value=0,t("updateQuery",""),t("close")},V=()=>g?l("ul",{class:"slimsearch-result-list"},l("li",{class:"slimsearch-result-list-item"},[l("div",{class:"slimsearch-result-title"},u.value.queryHistory),d.value.map((e,s)=>l("div",{class:["slimsearch-result-item",{active:r.isQuery&&r.index===s}],onClick:()=>{t("updateQuery",e)}},[l($,{class:"slimsearch-result-type"}),l("div",{class:"slimsearch-result-content"},e),l("button",{class:"slimsearch-remove-icon",innerHTML:P,onClick:m=>{m.preventDefault(),m.stopPropagation(),R(s)}})]))])):null,X=()=>w?l("ul",{class:"slimsearch-result-list"},l("li",{class:"slimsearch-result-list-item"},[l("div",{class:"slimsearch-result-title"},u.value.resultHistory),o.value.map((e,s)=>l(M,{to:e.link,class:["slimsearch-result-item",{active:!r.isQuery&&r.index===s}],onClick:()=>{b()}},()=>[l($,{class:"slimsearch-result-type"}),l("div",{class:"slimsearch-result-content"},[e.header?l("div",{class:"content-header"},e.header):null,l("div",e.display.map(m=>T(m)).flat())]),l("button",{class:"slimsearch-remove-icon",innerHTML:P,onClick:m=>{m.preventDefault(),m.stopPropagation(),A(s)}})]))])):null;return re("keydown",e=>{if(a.isFocusing){if(D.value){if(e.key==="ArrowUp")J();else if(e.key==="ArrowDown")z();else if(e.key==="Enter"){const s=Q.value.contents[v.value];h(a.queries.join(" ")),O(s),i.push(U(s)),b()}}else if(w){if(e.key==="ArrowUp")K();else if(e.key==="ArrowDown")Y();else if(e.key==="Enter"){const{index:s}=r;r.isQuery?(t("updateQuery",d.value[s]),e.preventDefault()):(i.push(o.value[s].link),b())}}}}),ue([p,v],()=>{var e;(e=document.querySelector(".slimsearch-result-list-item.active .slimsearch-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>l("div",{class:["slimsearch-result-wrapper",{empty:a.queries.length?!D.value:!E.value}],id:"slimsearch-results"},a.queries.length?G.value?l(ne,{hint:u.value.searching}):D.value?l("ul",{class:"slimsearch-result-list"},n.value.map(({title:e,contents:s},m)=>{const x=p.value===m;return l("li",{class:["slimsearch-result-list-item",{active:x}]},[l("div",{class:"slimsearch-result-title"},e||u.value.defaultTitle),s.map((c,Z)=>{const I=x&&v.value===Z;return l(M,{to:U(c),class:["slimsearch-result-item",{active:I,"aria-selected":I}],onClick:()=>{h(a.queries.join(" ")),O(c),b()}},()=>[c.type==="text"?null:l(c.type==="title"?oe:c.type==="heading"?me:ce,{class:"slimsearch-result-type"}),l("div",{class:"slimsearch-result-content"},[c.type==="text"&&c.header?l("div",{class:"content-header"},c.header):null,l("div",N(c))])])})])})):u.value.emptyResult:C?E.value?[V(),X()]:u.value.emptyHistory:u.value.emptyResult)}});export{Qe as default};
